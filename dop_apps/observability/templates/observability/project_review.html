{# templates/observability/project_review.html #}
{% extends "observability/base.html" %}
{% load static %}

{% block content %}

<section class="card">
  <h1 style="margin-top:0;">Data Observability Platform (Independent Project)</h1>

  <div class="overview-hero">
    <img
      src="{% static 'observability/images/architecture_diagram_darker_match.png' %}"
      alt="Data Observability Platform — architecture diagram"
      loading="lazy"
    >
  </div>

  <div class="overview-text">
    <p style="margin:0.6em 0 0 0;">
      This project is a production-style data observability platform. It ingests raw data, transforms it into
      a clean warehouse model, runs automated data-quality checks, and detects anomalies that open incidents.
      All dashboards read from secure database views, and access is enforced with Row-Level Security (RLS).
    </p>
  </div>
</section>

<!-- 1 + 2 are INDEPENDENT sections side-by-side (WITH GAP) -->
<div class="pair-grid" style="margin-top:1.2em;">
  <section class="card pair-card">
    <h3 style="margin-top:0;">1. Architecture</h3>
    <div style="opacity:.8; font-size:.95em; margin-top:.35em; line-height:1.4;">
      End-to-end flow: source → ingest → warehouse → ops → dashboards.
    </div>

    <div style="margin-top:0.6em; line-height:1.9;">
      • <a
          href="https://github.com/aujohn77/data-observability-platform/blob/main/docs/architecture_diagram.md"
          class="link"
          target="_blank"
          rel="noopener"
        >Architecture Diagram</a>
    </div>
  </section>

  <section class="card pair-card">
    <h3 style="margin-top:0;">2. Database Schema</h3>
    <div style="opacity:.8; font-size:.95em; margin-top:.35em; line-height:1.4;">
      Core tables, keys, and relationships used by the platform.
      Tables and view layer that define how data is stored and queried.
    </div>

    <div style="margin-top:0.6em; line-height:1.9;">
      • <a
          href="https://github.com/aujohn77/data-observability-platform/blob/main/docs/core_domain_erd.mmd"
          class="link"
          target="_blank"
          rel="noopener"
        >Core Domain ERD</a><br>

      • <a
          href="https://github.com/aujohn77/data-observability-platform/blob/main/docs/schema.md"
          class="link"
          target="_blank"
          rel="noopener"
        >Schema Documentation</a><br>

      • <a
          href="https://github.com/aujohn77/data-observability-platform/blob/main/docs/views.md"
          class="link"
          target="_blank"
          rel="noopener"
        >Dashboard Views (SQL Definitions)</a>
    </div>
  </section>
</div>

<!-- 3 is ONE section with internal columns (NO GAP / no mini-cards) -->
<section class="card" style="margin-top:1.2em;">
  <h3 style="margin-top:0;">3. Row-Level Security (RLS)</h3>
  <div style="opacity:.8; font-size:.95em; margin-top:.35em; line-height:1.4;">
    Access rules enforced in the database and verified by CI tests.
  </div>

  <div style="margin-top:0.6em;">
    <table style="width:100%; border-collapse:collapse; table-layout:fixed;">
      <colgroup>
        <col style="width:33.333%;">
        <col style="width:33.333%;">
        <col style="width:33.333%;">
      </colgroup>

      <tr>
        <th style="text-align:left; font-weight:700; padding:0.2em 0.6em 0.4em 0;">Policies</th>
        <th style="text-align:left; font-weight:700; padding:0.2em 0.6em 0.4em 0;">Verification Tests</th>
        <th style="text-align:left; font-weight:700; padding:0.2em 0 0.4em 0;">Automation (CI)</th>
      </tr>

      <tr style="vertical-align:top;">
        <td style="padding:0 0.6em 0 0; line-height:1.9; word-break:break-word;">
          • <a
              href="https://github.com/aujohn77/data-observability-platform/blob/main/docs/rls_policies.md"
              class="link"
              target="_blank"
              rel="noopener"
            >RLS Policies</a>
        </td>

        <td style="padding:0 0.6em 0 0; line-height:1.9; word-break:break-word;">
          • <a
              href="https://github.com/aujohn77/data-observability-platform/blob/main/db/tests/rls_security_verification_tests_ci.sql"
              class="link"
              target="_blank"
              rel="noopener"
            >RLS Verification Tests</a>
        </td>

        <td style="padding:0; line-height:1.9; word-break:break-word;">
          • <a
              href="https://github.com/aujohn77/data-observability-platform/blob/main/.github/workflows/security_rls_tests.yml"
              class="link"
              target="_blank"
              rel="noopener"
            >RLS Test Workflow</a><br>

          • <a
              href="https://github.com/aujohn77/data-observability-platform/actions/workflows/security_rls_tests.yml"
              class="link"
              target="_blank"
              rel="noopener"
            >RLS Test Status</a> ☑
        </td>
      </tr>
    </table>
  </div>
</section>

<!-- 4 is ONE section with internal columns (NO GAP / no mini-cards) -->
<section class="card" style="margin-top:1.2em;">
  <h3 style="margin-top:0;">4. Monitoring &amp; Operations</h3>
  <div style="opacity:.8; font-size:.95em; margin-top:.35em; line-height:1.4;">
    Dashboards, jobs, and automation for pipeline health and incidents.
  </div>

  <div style="margin-top:0.6em;">
    <table style="width:100%; border-collapse:collapse; table-layout:fixed;">
      <colgroup>
        <col style="width:33.333%;">
        <col style="width:33.333%;">
        <col style="width:33.333%;">
      </colgroup>

      <tr>
        <th style="text-align:left; font-weight:700; padding:0.2em 0.6em 0.4em 0;">Live Dashboards</th>
        <th style="text-align:left; font-weight:700; padding:0.2em 0.6em 0.4em 0;">Jobs</th>
        <th style="text-align:left; font-weight:700; padding:0.2em 0 0.4em 0;">Automation (CI)</th>
      </tr>

      <tr style="vertical-align:top;">
        <td style="padding:0 0.6em 0 0; line-height:1.9; word-break:break-word;">
          • <a href="{% url 'observability:control_tower' %}" class="link link-monitor">Monitoring Dashboard</a><br>
          • <a href="{% url 'observability:incidents' %}" class="link">Incidents</a><br>
          • <a href="{% url 'observability:stations' %}" class="link">Stations</a>
        </td>

        <td style="padding:0 0.6em 0 0; line-height:1.9; word-break:break-word;">
          • <a href="https://github.com/aujohn77/data-observability-platform/blob/main/jobs/ingest.py" class="link" target="_blank" rel="noopener">Data Ingestion</a><br>
          • <a href="https://github.com/aujohn77/data-observability-platform/blob/main/jobs/transform_fact.py" class="link" target="_blank" rel="noopener">Data Transformation</a><br>
          • <a href="https://github.com/aujohn77/data-observability-platform/blob/main/jobs/run_dq.py" class="link" target="_blank" rel="noopener">Data Quality Checks</a><br>
          • <a href="https://github.com/aujohn77/data-observability-platform/blob/main/jobs/run_anomaly_detection.py" class="link" target="_blank" rel="noopener">Anomaly &amp; Incident Handling</a>
        </td>

        <td style="padding:0; line-height:1.9; word-break:break-word;">
          • <a href="https://github.com/aujohn77/data-observability-platform/blob/main/.github/workflows/pipeline.yml" class="link" target="_blank" rel="noopener">Jobs Workflow</a>
        </td>
      </tr>
    </table>
  </div>
</section>

<section class="card" style="margin-top:1.2em;">
  <h3 style="margin-top:0;">5. Data Contracts</h3>
  <div style="opacity:.8; font-size:.95em; margin-top:.35em; line-height:1.4;">
    Expected data shape and validation rules for ingestion and transforms.
  </div>

  <div style="margin-top:0.6em;">
    • <a
        href="https://github.com/aujohn77/data-observability-platform/blob/main/docs/data_contracts.md"
        class="link"
        target="_blank"
        rel="noopener"
      >Data Contract Specification</a>
  </div>
</section>

<style>
  /* 1 + 2 layout: two independent cards with a GAP */
  .pair-grid{
    display:flex;
    gap:1em;
    flex-wrap:wrap;
    align-items:stretch;
  }
  .pair-card{
    flex:1 1 22em;
  }
</style>

{% endblock %}
