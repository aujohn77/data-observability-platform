{# templates/observability/project_review.html #}
{% extends "observability/base.html" %}

{% block content %}

<section class="card">
  <div style="text-align:center; padding:0.5em 0;">
    <div style="font-weight:800; letter-spacing:0.03em;">DATA OBSERVABILITY PLATFORM</div>
    <div style="opacity:0.9; margin-top:0.3em;">Production-Grade Data Monitoring &amp; Governance</div>
  </div>
</section>

<section class="card">
  <h3 style="margin-top:0;">Overview</h3>
  <p style="margin:0.6em 0 0 0;">
    This project demonstrates a production-style data platform with<br>
    database-enforced security, operational monitoring, and automated<br>
    validation.
  </p>
  <p style="margin:0.8em 0 0 0;">
    All claims below are backed by raw system exports and CI tests.
  </p>
</section>

<section class="card">
  <h3 style="margin-top:0;">1. Architecture</h3>
  <ul style="margin:0.6em 0 0 1.2em;">
    <li>Layered design: Raw â†’ Warehouse â†’ Ops</li>
    <li>Incremental ingestion, idempotent processing</li>
    <li>Database as system of record</li>
  </ul>

  <div style="margin-top:0.8em;">
    <a href="#" class="btn" id="open-arch-diagram">View Architecture Diagram</a>
  </div>
</section>

<section class="card">
  <h3 style="margin-top:0;">2. Database Schema</h3>
  <ul style="margin:0.6em 0 0 1.2em;">
    <li>Normalized warehouse model</li>
    <li>Explicit fact grain</li>
    <li>Operational metadata separated from analytics</li>
  </ul>

  <div style="margin-top:0.8em;">
    <a href="#" class="btn">View ERD</a>

    <a
      href="https://github.com/aujohn77/data-observability-platform/blob/main/docs/schema.md"
      class="btn"
      style="margin-left:0.6em;"
      target="_blank"
      rel="noopener"
    >
      Read schema.md
    </a>
  </div>
</section>


<section class="card">
  <h3 style="margin-top:0;">3. Security &amp; Row-Level Security (RLS)</h3>
  <ul style="margin:0.6em 0 0 1.2em;">
    <li>Database-native authorization (PostgreSQL RLS)</li>
    <li>No reliance on application-layer enforcement</li>
    <li>Least-privilege access model</li>
  </ul>

  <div style="margin-top:0.9em;">
    <div style="font-weight:700; margin-bottom:0.4em;">Evidence (system-generated):</div>
    <ul style="margin:0 0 0 1.2em;">
      <li>RLS policies (pg_policies)</li>
      <li>RLS enabled tables</li>
      <li>Function execution privileges</li>
    </ul>
  </div>

  <div style="margin-top:0.8em;">
    <a href="#" class="btn">Download rls_policies.csv</a>
  </div>

  <div style="margin-top:0.9em;">
    <div style="font-weight:700; margin-bottom:0.4em;">Enforcement:</div>
    <div style="opacity:0.95;">- CI security tests executed against live database</div>
  </div>

  <div style="margin-top:0.8em;">
    <a href="#" class="btn">View security_rls_smoke.sql</a>
    <a href="#" class="btn" style="margin-left:0.6em;">View GitHub Actions workflow</a>
  </div>
</section>

<section class="card">
  <h3 style="margin-top:0;">4. Operations &amp; Monitoring</h3>
  <div style="font-weight:700; margin-top:0.4em;">â–¶ Live Control Tower Dashboard</div>

  <div style="margin-top:0.9em; line-height:1.9;">
    ğŸ”— <a href="#">Job execution code (Python)</a><br>
    ğŸ”— <a href="#">Data quality checks (Python / SQL)</a><br>
    ğŸ”— <a href="#">Anomaly &amp; incident logic (Python / SQL)</a><br>
    ğŸ”— <a href="#">Pipeline automation (GitHub Actions .yml)</a>
  </div>
</section>

<section class="card">
  <h3 style="margin-top:0;">5. Data Contracts (optional)</h3>
  <ul style="margin:0.6em 0 0 1.2em;">
    <li>Canonical metrics and units</li>
    <li>Time semantics and lateness rules</li>
    <li>Validation expectations</li>
  </ul>

  <div style="margin-top:0.8em;">
    <a href="#" class="btn">Read data_contracts.md</a>
    <a href="#" class="btn" style="margin-left:0.6em;">Download metric_inventory.csv</a>
  </div>
</section>

<section class="card">
  <h3 style="margin-top:0;">Repository &amp; Automation</h3>
  <ul style="margin:0.6em 0 0 1.2em;">
    <li>Full source code</li>
    <li>CI pipelines</li>
    <li>Scheduled ingestion jobs</li>
  </ul>

  <div style="margin-top:0.8em;">
    <a href="#" class="btn">GitHub Repository</a>
    <a href="#" class="btn" style="margin-left:0.6em;">CI Workflows</a>
  </div>
</section>

<section class="card" style="text-align:center; opacity:0.9;">
  End of technical review material
</section>





<!-- Architecture Diagram Modal -->
<div class="modal-backdrop" id="arch-modal" aria-hidden="true">
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="arch-title">
    <div class="modal-head">
      <div>
        <div id="arch-title" class="modal-title">Architecture Diagram</div>
        <div class="modal-subtitle">End-to-end platform flow (raw â†’ warehouse â†’ ops)</div>
      </div>
      <button class="modal-close" id="close-arch-modal" aria-label="Close">Ã—</button>
    </div>

    <div class="modal-body">
      <pre class="ascii-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ External Data Sources    â”‚
â”‚ (Public Sensors / APIs)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ingestion Jobs           â”‚
â”‚ (Scheduled / CI-trigger) â”‚
â”‚ â€¢ incremental            â”‚
â”‚ â€¢ idempotent             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RAW LAYER (Database)     â”‚
â”‚ raw_observations         â”‚
â”‚ â€¢ append-only            â”‚
â”‚ â€¢ source payload stored  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TRANSFORM / MODEL        â”‚
â”‚ Jobs (CI / Workers)      â”‚
â”‚ â€¢ normalize              â”‚
â”‚ â€¢ deduplicate            â”‚
â”‚ â€¢ enforce contracts      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WAREHOUSE LAYER          â”‚
â”‚ fact_observation         â”‚
â”‚ dim_station              â”‚
â”‚ dim_metric               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OPS / OBSERVABILITY      â”‚
â”‚ ops_job_run              â”‚
â”‚ ops_dq_check_run         â”‚
â”‚ ops_anomaly              â”‚
â”‚ ops_incident             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ APPLICATION / DASHBOARD  â”‚
â”‚ (Read-only views)        â”‚
â”‚ â€¢ Status                 â”‚
â”‚ â€¢ Incidents              â”‚
â”‚ â€¢ Stations               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USERS                    â”‚
â”‚ â€¢ anon                   â”‚
â”‚ â€¢ analyst                â”‚
â”‚ â€¢ ops                    â”‚
â”‚ (RLS enforced in DB)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      </pre>
    </div>
  </div>
</div>













<style>
  /* Minimal button style (works even if your base CSS has none) */
  .btn{
    display:inline-block;
    padding:0.45em 0.8em;
    border:1px solid rgba(255,255,255,0.18);
    border-radius:0.6em;
    text-decoration:none;
    color:inherit;
    background:rgba(255,255,255,0.04);
  }
  .btn:hover{ background:rgba(255,255,255,0.08); }



  /* Modal (matches your dark card style) */
  .modal-backdrop{
    position:fixed; inset:0;
    background:rgba(0,0,0,0.55);
    display:none;
    align-items:center;
    justify-content:center;
    padding:2vh 2vw;
    z-index:9999;
  }
  .modal-backdrop.is-open{ display:flex; }

  .modal-card{
    width:min(64em, 96vw);
    background:rgba(10,16,24,0.95);
    border:1px solid rgba(255,255,255,0.12);
    border-radius:1em;
    box-shadow:0 20px 60px rgba(0,0,0,0.55);
    overflow:hidden;
  }

  .modal-head{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:1em;
    padding:1em 1.1em;
    border-bottom:1px solid rgba(255,255,255,0.10);
  }
  .modal-title{ font-weight:800; letter-spacing:0.02em; }
  .modal-subtitle{ opacity:0.85; margin-top:0.2em; font-size:0.95em; }

  .modal-close{
    border:1px solid rgba(255,255,255,0.16);
    background:rgba(255,255,255,0.06);
    color:inherit;
    border-radius:0.7em;
    width:2.2em;
    height:2.2em;
    cursor:pointer;
    line-height:1;
    font-size:1.2em;
  }
  .modal-close:hover{ background:rgba(255,255,255,0.10); }

  .modal-body{
    padding:1em 1.1em 1.2em 1.1em;
    overflow:auto;
    max-height:78vh;
  }

  .ascii-diagram{
    margin:0;
    padding:0.9em 1em;
    background:rgba(255,255,255,0.03);
    border:1px solid rgba(255,255,255,0.10);
    border-radius:0.8em;
    white-space:pre;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size:0.92em;
    line-height:1.35;
  }



</style>








<script>
  (function(){
    const openBtn = document.getElementById("open-arch-diagram");
    const modal = document.getElementById("arch-modal");
    const closeBtn = document.getElementById("close-arch-modal");

    function openModal(){
      modal.classList.add("is-open");
      modal.setAttribute("aria-hidden","false");
    }
    function closeModal(){
      modal.classList.remove("is-open");
      modal.setAttribute("aria-hidden","true");
    }

    openBtn?.addEventListener("click", (e) => {
      e.preventDefault();
      openModal();
    });
    closeBtn?.addEventListener("click", closeModal);

    modal?.addEventListener("click", (e) => {
      if(e.target === modal) closeModal();
    });

    document.addEventListener("keydown", (e) => {
      if(e.key === "Escape" && modal.classList.contains("is-open")) closeModal();
    });
  })();
</script>




{% endblock %}
